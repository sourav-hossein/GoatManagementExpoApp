import React from 'react';
import { StyleSheet, View, FlatList } from 'react-native';
import { useTheme } from 'react-native-paper';
import { useAppSelector } from '@/store/hooks';
import EmptyState from '@/components/EmptyState';
import HealthRecordListItem from '@/components/HealthRecordListItem';

type HealthTabProps = {
  goatId: string;
};

export default function HealthTab({ goatId }: HealthTabProps) {
  const { colors } = useTheme();
  const { records } = useAppSelector((state) => state.health);
  const goatHealthRecords = records.filter(r => r.goatId === goatId);

  if (goatHealthRecords.length === 0) {
    return (
      <View style={[styles.container, { backgroundColor: colors.background }]}>
        <EmptyState
          title="No Health Records"
          message="Vaccinations, treatments, and checkups for this goat will appear here."
        />
      </View>
    );
  }

  return (
    <FlatList
      data={goatHealthRecords}
      keyExtractor={(item) => item.id}
      renderItem={({ item }) => <HealthRecordListItem record={item} />}
      contentContainerStyle={[styles.list, { backgroundColor: colors.background }]}
    />
  );
}

const styles = StyleSheet.create({
  container: { flex: 1, justifyContent: 'center', alignItems: 'center' },
  list: { flex: 1, paddingTop: 16, paddingHorizontal: 16 },
});
